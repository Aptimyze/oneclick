.modal.fade{id: "feedback_modal"}
  .modal-dialog.modal-lg
    .modal-content#ratings
      .modal-header.clearfix
        %btn.btn.btn-default.action-button.pull-right{data: {dismiss: "modal"}}= t(:close)
        -# If the public can read feedback...
        - if can? :create, rateable.ratings.build(rateable: rateable)
          %button.btn.action-button.btn-default.pull-right#load_feedback
            = t(:feedback)
      .modal-body
        .panel.panel-default
          .panel-heading
            %h3
              = rateable.name
          .panel-body
            -unless rateable.ratings.approved.empty?
              %dl.dl-horizontal
                - rateable.ratings.approved.decorate.each do |r|
                  %dt.rating-value= r.rating_in_stars
                  %dd.rating-comments= r.comments 
            -else
              .alert
                =t(:no_ratings_yet)
    .modal-content#give_feedback
                
-# Load in the form dynamically
- if can? :create, rateable.ratings.build(rateable: rateable)
  :javascript
    $(document).ready(function() {
      $("#load_feedback").on("click", function() {
        $("#ratings").hide();
        $("#give_feedback").show();
        $.ajax({
          url: "#{RateableDecorator.new(rateable).new_rateable_rating_path}",
          context: $("#give_feedback"),
          dataType: "html"
        })
        .then( function(html) {
          $(this).html(html)
        });
      });
    });